以下は、チャット形式の漫画を作成するWebアプリケーション「Chat Manga Editor」を再現するためのプロンプトです。

---

### 総合的な要件

単一のHTMLファイルで構成される、JavaScript製のインタラクティブなチャット漫画エディタを開発してください。ユーザーはチャットのような吹き出しとキャラクター画像を組み合わせたコマや、大きなイラスト画像を自由に追加・編集できます。

### 1. 基本レイアウトとスタイル

- **ページ全体**: 背景色は薄いグレー (`#f0f0f0`) とします。
- **ヘッダー**: ページ上部に配置し、編集可能な漫画のタイトルを表示します。タイトルは中央揃えの大きなフォントサイズ(`32px`)で、デフォルト値は「タイトルを入力...」です。
- **コミックコンテナ (`#comic-container`)**: 漫画の全コマが配置されるメインエリアです。
    - 幅 `800px` でページ中央に配置します。
    - 背景色は白に近いグレー (`#f9f9f9`)、内側に `40px` の余白を持ち、薄いグレーの枠線 (`1px solid #ddd`) と微かな影 (`box-shadow`) を付けます。
    - 内部の各コマは縦に並び、`50px` の間隔を空けます。
- **グローバルコントロール**: コミックコンテナの下に配置されるボタン群です。
    - 「＋ コマ追加」「＋ イラスト追加」「プレビュー」の3つのボタンを中央揃えで配置します。

### 2. コマの種類

#### 2.1. チャットパネル (`.panel`)

- **構造**: 左側にキャラクター画像、右側に吹き出し（テキストエリア）を配置した横長のパネルです。
- **吹き出し (`.text-box`)**: 
    - 縦書きのリサイズが可能なテキストエリア (`textarea`) を持ちます。
    - テキストエリアは角丸で、右端から三角形のしっぽが生えた吹き出しのようなデザインです。
    - 吹き出しは、キャラクター画像より少し下にずらして配置します。
- **キャラクター画像 (`.face`)**: 
    - `200x200px` の正方形の領域です。
    - クリックすると画像ファイルをアップロードできます。画像が選択されていない場合は薄いグレーの枠線を表示します。
    - アップロードされた画像は、領域内に収まるように `object-fit: contain` で表示します。

#### 2.2. イラストパネル (`.image-panel`)

- **構造**: `600x400px` の大きな長方形の領域で、コミックコンテナの中央に配置されます。
- **機能**: クリックすると画像ファイルをアップロードでき、大きな一枚絵として表示されます。

### 3. インタラクションと編集機能

- **アクティブパネル機能**:
    - いずれかのコマ（チャットパネルまたはイラストパネル）をクリックすると、そのコマが「編集中」の状態になります。
    - 編集中になったコマは、青い太枠 (`2px solid #4a90e2`) と青い影でハイライトされます。
    - 同時にアクティブにできるコマは1つだけです。別のコマをクリックすると、そちらがアクティブになります。
    - コミックコンテナの背景部分をクリックすると、すべてのアクティブ状態が解除されます。

- **パネルコントロール (`.panel-controls`)**:
    - コマがアクティブになると、そのコマの枠線のすぐ下に専用の操作ボタン群が表示されます。
    - **チャットパネルの場合**: 「コマ左右反転」「画像左右反転」「コマ削除」の3つのボタンが表示されます。
        - **コマ左右反転**: クリックすると、キャラクター画像と吹き出しの位置が左右入れ替わります。
        - **画像左右反転**: クリックすると、キャラクター画像のみが水平方向に反転します。この際、吹き出しが画像の背後に隠れないように、重なり順を適切に制御してください。
        - **コマ削除**: クリックすると、そのチャットパネル全体が削除されます。
    - **イラストパネルの場合**: 「コマ削除」ボタンのみが表示され、クリックするとそのイラストパネルが削除されます。

### 4. プレビュー機能

- **プレビューボタン**: グローバルコントロールにある「プレビュー」ボタンをクリックすると、プレビューモードに切り替わります。
- **プレビューモード中の表示**:
    - すべての操作ボタン（グローバルコントロール、パネルコントロール）が非表示になります。
    - アクティブなコマを囲む青い枠線も非表示になります。
    - これにより、完成した漫画の見た目を純粋に確認できます。
- **プレビューモードの解除**: プレビューモード中に画面の任意の場所をクリックすると、編集モードに戻ります。

### 5. 初期状態

- ページを読み込んだ際、コミックコンテナには空のチャットパネルが1つだけ追加され、アクティブな状態になっています。
